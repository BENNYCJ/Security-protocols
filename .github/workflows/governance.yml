name: CISO Governance Bot

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  compliance-check:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Run CISO Compliance Scan
        run: |
          echo "üîç Starting Compliance Scan..."
          has_error=0

          # Check 1: The Manual
          if [ -f "PROTOCOL.md" ]; then
            echo "‚úÖ PROTOCOL.md found."
          else
            echo "‚ùå ERROR: PROTOCOL.md is missing!"
            has_error=1
          fi

          # Check 2: The Shield (CRITICAL)
          if [ -f ".gitignore" ]; then
            echo "‚úÖ .gitignore found."
          else
            echo "‚ùå CRITICAL ERROR: .gitignore is missing! You are at risk of leaking keys."
            has_error=1
          fi

          # Final Verdict
          if [ $has_error -eq 1 ]; then
            echo "üëÆ Scan Failed. Merge Blocked."
            exit 1
          else
            echo "üéâ All Checks Passed."
            exit 0
          fi
